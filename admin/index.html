<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- IMPORTANT for GitHub Pages under /menu/ -->
  <base href="/menu/">

  <title>Stardust Admin</title>
  <link rel="stylesheet" href="admin/admin.css" />
</head>
<body>
  <header class="topbar">
    <div class="title">Stardust Admin</div>
    <div class="right">
      <span id="userEmail" class="muted"></span>
      <button id="logoutBtn" class="btn ghost hidden">Logout</button>
    </div>
  </header>

  <!-- AUTH -->
  <main class="wrap">
    <section id="authView" class="card">
      <h2>Login</h2>
      <p class="muted">Use your Supabase Email/Password account.</p>

      <div class="grid2">
        <label>
          <span>Email</span>
          <input id="email" type="email" placeholder="you@email.com" autocomplete="email" />
        </label>
        <label>
          <span>Password</span>
          <input id="password" type="password" placeholder="••••••••" autocomplete="current-password" />
        </label>
      </div>

      <div class="row">
        <button id="loginBtn" class="btn">Login</button>
        <button id="forgotBtn" class="btn ghost">Forgot password</button>
      </div>

      <div class="hr"></div>

      <!-- Password recovery UI (only appears when Supabase sends recovery state) -->
      <div id="recoveryBox" class="hidden">
        <h3>Set a new password</h3>
        <label>
          <span>New password</span>
          <input id="newPassword" type="password" placeholder="New password" />
        </label>
        <div class="row">
          <button id="setPasswordBtn" class="btn">Update password</button>
        </div>
      </div>

      <p id="authMsg" class="msg"></p>
    </section>

    <!-- ADMIN -->
    <section id="adminView" class="admin hidden">
      <aside class="sidebar card">
        <div class="sidebarHeader">
          <h3>Brands</h3>
          <button id="newBrandBtn" class="btn small">+ Brand</button>
        </div>

        <input id="brandSearch" class="input" placeholder="Search brand..." />
        <div id="brandList" class="list"></div>

        <div class="hint">
          <div><b>Home order:</b> Clearance first, then Sort Price (low→high), then Sort Order.</div>
        </div>
      </aside>

      <section class="content card">
        <div class="contentHeader">
          <h3 id="brandHeading">Select a brand</h3>
          <div class="row">
            <button id="saveBrandBtn" class="btn small hidden">Save Brand</button>
            <button id="deleteBrandBtn" class="btn small danger hidden">Delete Brand</button>
          </div>
        </div>

        <div id="brandEditor" class="hidden">
          <h4>Brand (Home Card + Header)</h4>
          <div class="grid2">
            <label><span>ID (slug)</span><input id="b_id" class="input" /></label>
            <label><span>Name</span><input id="b_name" class="input" /></label>
            <label><span>Puffs</span><input id="b_puffs" class="input" /></label>
            <label><span>Price Text</span><input id="b_price_text" class="input" /></label>
            <label><span>Deal Text</span><input id="b_deal_text" class="input" /></label>
            <label><span>Card Image (path/url)</span><input id="b_card_image" class="input" /></label>
            <label><span>File Path (optional)</span><input id="b_file_path" class="input" /></label>

            <label class="rowLeft">
              <input id="b_clearance" type="checkbox" />
              <span>Clearance</span>
            </label>

            <label><span>Sort Price (number)</span><input id="b_sort_price" class="input" type="number" step="0.01" /></label>
            <label><span>Sort Order (optional)</span><input id="b_sort_order" class="input" type="number" step="1" /></label>
          </div>

          <div class="hr"></div>

          <div class="flavorsHeader">
            <h4>Flavors</h4>
            <button id="addFlavorBtn" class="btn small">+ Flavor</button>
          </div>

          <div id="flavorList" class="flavorList"></div>
        </div>

        <p id="adminMsg" class="msg"></p>
      </section>
    </section>
  </main>

  <script type="module" src="admin/admin.js"></script>
</body>
</html>
